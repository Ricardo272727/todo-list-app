(this["webpackJsonptodo-list-app"]=this["webpackJsonptodo-list-app"]||[]).push([[0],{101:function(e,t,a){},102:function(e,t,a){},103:function(e,t,a){},104:function(e,t,a){},106:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(18),s=a.n(c),l=a(8),o=a(67),i=a(7),u=a(30),m=a(61),d="SET_TASKS",f="SET_USER",p="SET_USERS",E="SET_ASIDE_PANEL",b="SET_MAIN_CONTENT",g="ADD_TASK",h="ASSIGN TASK",O="EDIT_TASK",j="DELETE_TASK",k="SET_LOGIN_ERRORS",w="SET_REGISTER_ERRORS",v="SET_GLOBAL_ERROR",S=function(e){return{type:b,mainContent:e}},T={appName:"Todo list app",tasks:[],user:null,users:[{id:1,name:"Britanny idelfonsa"},{id:2,name:"Atenea"},{id:3,name:"Puppy"},{id:0,name:"Ricardo Cuanalo"}],asidePanel:null,mainContent:"all",loginErrors:{},registerErrors:{},modifyUserErrors:{},globalError:null},y=Object(u.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return Object(i.a)(Object(i.a)({},e),{},{tasks:t.tasks});case f:return Object(i.a)(Object(i.a)({},e),{},{user:t.user});case p:return Object(i.a)(Object(i.a)({},e),{},{users:t.users});case E:return Object(i.a)(Object(i.a)({},e),{},{asidePanel:t.asidePanel});case b:return Object(i.a)(Object(i.a)({},e),{},{mainContent:t.mainContent});case h:return Object(i.a)(Object(i.a)({},e),{},{tasks:e.tasks.map((function(e){return e._id===t.taskId&&(e.assignedTo=t.userId),e}))});case O:return Object(i.a)(Object(i.a)({},e),{},{tasks:e.tasks.map((function(e){return e._id===t.taskId&&(e.text=t.text),e}))});case j:return Object(i.a)(Object(i.a)({},e),{},{tasks:e.tasks.filter((function(e){return e._id!==t.taskId}))});case g:return Object(i.a)(Object(i.a)({},e),{},{tasks:[t.task].concat(Object(o.a)(e.tasks))});case k:return Object(i.a)(Object(i.a)({},e),{},{loginErrors:t.errors});case w:return Object(i.a)(Object(i.a)({},e),{},{registerErrors:t.errors});case v:return Object(i.a)(Object(i.a)({},e),{},{globalError:t.error});default:return e}}),Object(u.a)(m.a)),N=a(17),C=a(12),x=a(20),I=a(14),_=a(107),P=a(108),D=a(109),A=a(110),R=a(111),F=a(112),L=a(113),J=a(34),U=(a(82),function(e){return r.a.createElement("form",{onSubmit:e.onSubmit,className:"form-cu"},e.children)}),q="http://localhost:5000/login",G="http://localhost:5000/logout",z="http://localhost:5000/register",K="http://localhost:5000/user",B="http://localhost:5000/users",M="http://localhost:5000/task",Y=function(){var e=new Date;return String(e.getDate()).padStart(2,"0")+"/"+String(e.getMonth()+1).padStart(2,"0")+"/"+String(e.getFullYear())};console.log(Y());var W=function(){return function(e){fetch(M,{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(t){var a;t.tasks&&e((a=t.tasks,{type:d,tasks:a}))})).catch((function(e){}))}},$=function(e){var t=e.taskId,a=e.text,n=e.assignedTo,r=e.success,c=e.failed;return console.log("modifiing task"),function(e){if(t&&(a||n)){var s={_id:t,task:{}};n&&(s.task.assignedTo=n),a&&(s.task.text=a),fetch(M,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(s){s.ok?(a&&e(V(t,a)),n&&e(Q(n,t)),r&&r()):c&&c()})).catch((function(e){c&&c()}))}}},H=function(e){return{type:g,task:e}},Q=function(e,t){return{type:h,userId:e,taskId:t}},V=function(e,t){return{type:O,taskId:e,text:t}},X=function(e){return{type:j,taskId:e}},Z=function(e){return{type:f,user:e}},ee=function(e){return{type:k,errors:e}},te=function(e){return{type:w,errors:e}},ae=function(){return console.log("getting users",B),function(e){fetch(B,{method:"GET",credentials:"include"}).then((function(e){return e.json()})).then((function(t){var a;console.log("response getting users",t),t.errors||e((a=t.users,{type:p,users:a}))})).catch((function(e){}))}},ne=function(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)},re=function(e){return 0===e.length},ce=a(24),se=function(e){var t=e.target;return t?"checkbox"===t.type?t.checked:t.value:null},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=Object(n.useState)(e),r=Object(I.a)(a,2),c=r[0],s=r[1],l=Object(n.useState)({}),o=Object(I.a)(l,2),u=o[0],m=o[1],d=function(e){return m(Object(i.a)(Object(i.a)({},u),{},Object(ce.a)({},e,null)))},f=function(e,t){return m(Object(i.a)(Object(i.a)({},u),{},Object(ce.a)({},e,t)))},p=function(e){var a=e.target,n=a.name,r=a.value;t&&E(n,r),s(Object(i.a)(Object(i.a)({},c),{},Object(ce.a)({},n,se(e))))},E=function(e,a){var n=t(e,a);return n.error?(f(e,n.error),!1):n.validator?n.validator(c)?(d(e),!0):(f(e,n.message),!1):(d(e),!0)},b=function(e,t){return{name:e,value:c[e],onChange:p}},g=function(e){return{name:e,checked:c[e],onChange:p}},h=function(){if(!t)return!0;for(var e=Object.keys(c),a=0;a<e.length;a+=1)if(!E(e[a],c[e[a]]))return!1;return!0};return{getInput:b,getCheckbox:g,errors:u,fields:c,validate:h}},oe=(a(83),"todolistapp-email"),ie={email:localStorage.getItem(oe)?localStorage.getItem(oe):"",password:""},ue=function(e,t){switch(e){case"email":return re(a=t)?{error:"This field is required"}:!!ne(a)||{error:"Invalid email address"};case"password":return!re(t)||{error:"Password is required"};default:return!0}var a},me=function(e){var t=Object(l.b)(),a=Object(l.c)((function(e){return e.appName})),c=Object(l.c)((function(e){return e.loginErrors})),s=le(ie,ue),o=Object(n.useState)("true"===localStorage.getItem("todolistapp-rememberme")),i=Object(I.a)(o,2),u=i[0],m=i[1];return r.a.createElement(_.a,{className:"login-screen"},r.a.createElement(P.a,null,r.a.createElement(D.a,{xs:12,md:{size:4,offset:4}},r.a.createElement(U,{onSubmit:function(e){e.preventDefault(),s.validate()&&(console.log(s.fields),t(function(e){var t=e.email,a=e.password;return console.log("Login with:",t,a),function(e){return fetch(q,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:a}),credentials:"include"}).then((function(e){return e.json()})).then((function(t){t.errors?e(ee(t.errors)):(e(Z(t.user)),e(ae()),e(W()))})).catch((function(t){e(ee(t))}))}}({email:s.fields.email,password:s.fields.password})))}},r.a.createElement("header",null,r.a.createElement(J.a,null),r.a.createElement("h2",null,a)),r.a.createElement(A.a,null,r.a.createElement(R.a,{htmlFor:"email"},"Email"),r.a.createElement(F.a,Object.assign({type:"email"},s.getInput("email"))),(s.errors.email||c.email)&&r.a.createElement(L.a,null,s.errors.email||c.email)),r.a.createElement(A.a,null,r.a.createElement(R.a,{htmlFor:"password"},"Password"),r.a.createElement(F.a,Object.assign({type:"password"},s.getInput("password"))),(s.errors.password||c.password)&&r.a.createElement(L.a,null,s.errors.password||c.password)),r.a.createElement(A.a,null,r.a.createElement(F.a,{type:"checkbox",onChange:function(e){e.target.checked?(m(!0),localStorage.setItem("todolistapp-rememberme",!0),localStorage.setItem(oe,s.fields.email)):(m(!1),localStorage.setItem("todolistapp-rememberme",!1),localStorage.removeItem(oe))},checked:u}),r.a.createElement(R.a,{htmlFor:"rememberMe"},"Remember me")),r.a.createElement(A.a,null,r.a.createElement("button",{type:"submit"},"Login")),r.a.createElement(A.a,null,r.a.createElement(N.b,{to:"/register"},"Or sign in here"))))))},de=(a(85),a(86),a(64)),fe=a(25),pe=a(117),Ee=a(116),be=a(115),ge=a(114),he=function(e){var t=Object(l.b)(),a=Object(n.useState)(""),r=Object(I.a)(a,2),c=r[0],s=r[1],o=Object(n.useState)(!1),i=Object(I.a)(o,2),u=i[0],m=i[1],d=Object(n.useState)(!1),f=Object(I.a)(d,2),p=f[0],E=f[1],b=Object(n.useState)(!1),g=Object(I.a)(b,2),h=g[0],O=g[1],j=function(){return O(!h)},k=Object(n.useRef)(null),w=Object(x.useToasts)().addToast,v=function(){return w("Network error, please verify your internet connection",{appearance:"error"})};Object(n.useEffect)((function(){p&&k&&k.current&&k.current.focus()}),[p]);return{text:c,setText:s,editable:p,edit:function(){E(!0)},save:function(){E(!1),t($({taskId:e._id,text:c,success:function(){return w("Task saved",{appearance:"success",autoDismiss:!0})},failed:v}))},dropdownOpen:u,toggleDropdown:function(){return m(!u)},assignTo:function(a){t($({assignedTo:a,taskId:e._id,success:function(){return w("Task updated",{appearance:"success",autoDismiss:!0})},failed:v}))},deleting:h,toggleDeleting:j,deleteFunc:function(){t(function(e){var t=e._id,a=e.success,n=e.failed;return function(e){fetch(M,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t})}).then((function(e){return e.json()})).then((function(r){r.ok?(e(X(t)),a&&a()):r.errors&&n&&n()})).catch((function(e){n&&n()}))}}({_id:e._id,success:function(){return w("Task deleted",{appearance:"success",autoDismiss:!0})},failed:v})),j()},textareaRef:k}},Oe=(a(87),function(e){return e.show?r.a.createElement("main",{className:"alert-cu"},r.a.createElement("div",{className:"body"},r.a.createElement("div",{className:"close"},r.a.createElement("button",{onClick:e.onCancel},r.a.createElement(fe.b,null))),r.a.createElement("div",{className:"message"},r.a.createElement("p",null,e.message)),r.a.createElement("div",{className:"controls"},r.a.createElement("button",{className:"onCancel",onClick:e.onCancel},"Cancel"),r.a.createElement("button",{className:"onAccept",onClick:e.onAccept},"Yes")))):null}),je=function(e){var t=Object(l.c)((function(e){return e.users})),a=he(e.task);return Object(n.useEffect)((function(){a.setText(e.task.text)}),[e.task.text,a.setText]),r.a.createElement(_.a,{className:"task"},r.a.createElement(P.a,null,r.a.createElement(D.a,{xs:4,className:"option assign"},r.a.createElement(pe.a,{isOpen:a.dropdownOpen,toggle:a.toggleDropdown},r.a.createElement(Ee.a,{caret:!0},r.a.createElement(fe.a,null)),r.a.createElement(be.a,null,t.map((function(t){return r.a.createElement("div",{key:t._id||t.id},r.a.createElement(ge.a,{className:t._id===e.task.assignedTo?"selected":"",onClick:function(){return a.assignTo(t._id)}},t.name),r.a.createElement(ge.a,{divider:!0}))}))))),r.a.createElement(D.a,{xs:4,className:"option edit"},a.editable&&r.a.createElement("button",{onClick:a.save},r.a.createElement(fe.d,null)),!a.editable&&r.a.createElement("button",{onClick:a.edit},r.a.createElement(de.a,null))),r.a.createElement(D.a,{xs:4,className:"option delete"},r.a.createElement("button",{onClick:a.toggleDeleting},r.a.createElement(fe.c,null)))),r.a.createElement(P.a,null,r.a.createElement(D.a,{xs:12,className:"content",onClick:function(){return a.edit()},onBlur:function(){return a.save()}},!a.editable&&r.a.createElement("p",null,e.task.text),a.editable&&r.a.createElement("textarea",{ref:a.textareaRef,name:"task",value:a.text,onChange:function(e){return a.setText(e.target.value)}}))),r.a.createElement(Oe,{show:a.deleting,onCancel:a.toggleDeleting,onAccept:a.deleteFunc,message:"Are you sure want delete this task?"}))},ke=function(e){var t=Object(l.c)((function(e){return e.tasks})),a=Object(l.c)((function(e){return e.mainContent})),c=Object(l.c)((function(e){return e.user})),s=Object(n.useState)([]),o=Object(I.a)(s,2),i=o[0],u=o[1];return Object(n.useEffect)((function(){u("assignments"===a?t.filter((function(e){return e.assignedTo===c._id})):t)}),[a,t]),r.a.createElement(_.a,{fluid:!0},r.a.createElement(P.a,null,i.map((function(e){return r.a.createElement(D.a,{xs:6,md:3,key:e._id||e.id},r.a.createElement(je,{task:e}))}))))},we=(a(101),{name:"",email:"",password:"",passwordConfirm:""}),ve=function(e,t){switch(e){case"name":if(re(t))return{error:"Name is required"};break;case"email":if(re(t))return{error:"Email is required"};if(!ne(t))return{error:"Invalid email address"};break;case"password":if(re(t))return{error:"Password is required"};break;case"passwordConfirm":return re(t)?{error:"This field is required"}:{validator:function(e){return t===e.password},message:"Password must match"}}return!0},Se=function(e){var t=le(we,ve),a=Object(l.c)((function(e){return e.registerErrors})),n=Object(l.b)();return r.a.createElement(_.a,{className:"register-screen"},r.a.createElement(P.a,null,r.a.createElement(D.a,{xs:12,md:{size:4,offset:4}},r.a.createElement(U,{onSubmit:function(e){e.preventDefault(),t.validate()&&(console.log("Submit register data",t.fields),n(function(e){var t=e.name,a=e.email,n=e.password;return function(e){fetch(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,email:a,password:n})}).then((function(e){return e.json()})).then((function(t){t.errors?e(te(t.errors)):(e(Z(t.user)),e(ae()),e(W()))})).catch((function(t){e(te(t))}))}}({name:t.fields.name,email:t.fields.email,password:t.fields.password})))}},r.a.createElement("header",null,r.a.createElement(J.a,null),r.a.createElement("h3",null,"Sign in")),r.a.createElement(A.a,null,r.a.createElement(R.a,{htmlFor:"name"},"Name"),r.a.createElement(F.a,Object.assign({type:"text"},t.getInput("name"))),(t.errors.name||a.name)&&r.a.createElement(L.a,null,t.errors.name||a.name)),r.a.createElement(A.a,null,r.a.createElement(R.a,{htmlFor:"email"},"Email"),r.a.createElement(F.a,Object.assign({type:"email"},t.getInput("email"))),(t.errors.email||a.email)&&r.a.createElement(L.a,null,t.errors.email||a.email)),r.a.createElement(A.a,null,r.a.createElement(R.a,{htmlFor:"password"},"Password"),r.a.createElement(F.a,Object.assign({type:"password"},t.getInput("password"))),(t.errors.password||a.password)&&r.a.createElement(L.a,null,t.errors.password)),r.a.createElement(A.a,null,r.a.createElement(R.a,{htmlFor:"passwordConfirm"},"Password confirm"),r.a.createElement(F.a,Object.assign({type:"password"},t.getInput("passwordConfirm"))),t.errors.passwordConfirm&&r.a.createElement(L.a,null,t.errors.passwordConfirm)),r.a.createElement(A.a,null,r.a.createElement("button",{type:"submit"},"Sign in")),r.a.createElement(A.a,null,r.a.createElement(N.b,{to:"/"},"Or login here"))))))},Te=(a(102),function(e){var t=Object(l.c)((function(e){return e.user})),a=Object(l.c)((function(e){return e.modifyUserErrors})),c=Object(n.useState)(!0),s=Object(I.a)(c,2),o=s[0],u=s[1],m=Object(l.b)(),d=Object(x.useToasts)().addToast,f=le({name:t.name,password:""});return Object(n.useEffect)((function(){f.fields.name!==t.name||f.fields.password.length>0?u(!1):u(!0)}),[f.fields.name,f.fields.password]),r.a.createElement(_.a,{className:"pt-5 profile"},r.a.createElement(P.a,{className:"px-3 mb-5"},r.a.createElement(D.a,{xs:4,md:{size:1,offset:4},className:"user-photo"},r.a.createElement("img",{src:t.photo||"/user.png",alt:"Profile",className:"img-fluid"})),r.a.createElement(D.a,{xs:8,md:{size:3},className:"d-flex align-items-center username"},r.a.createElement("b",{className:"m-0 p-0"},t.email))),r.a.createElement(P.a,null,r.a.createElement(D.a,{xs:12,md:{size:4,offset:4}},r.a.createElement(U,{onSubmit:function(e){e.preventDefault(),m(function(e){var t=e._id,a=e.name,n=e.password,r=e.success,c=e.failed;return function(e,s){if(!t||!a&&!n)return Promise.resolve();var l={};a&&s().user.name!==a&&(l.name=a),n&&s().user.password!==n&&(l.password=n),fetch(K,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t,user:l})}).then((function(e){return e.json()})).then((function(t){e(Z(Object(i.a)(Object(i.a)({},s().user),l))),r&&r()})).catch((function(e){c&&c()}))}}({_id:t._id,name:f.fields.name,password:f.fields.password,success:function(){return d("User updated correctly",{appearance:"success",autoDismiss:!0})},failed:function(){return d("Network error please verify your connection",{appearance:"error"})}}))}},r.a.createElement(A.a,null,r.a.createElement(R.a,{htmlFor:"name"},"Username"),r.a.createElement(F.a,Object.assign({type:"text"},f.getInput("name"))),(f.errors.name||a.name)&&r.a.createElement(L.a,null,f.errors.name||a.name)),r.a.createElement(A.a,null,r.a.createElement(R.a,{htmlFor:"password"},"Password"),r.a.createElement(F.a,Object.assign({type:"password"},f.getInput("password"))),(f.errors.password||a.password)&&r.a.createElement(L.a,null,f.errors.password||a.password)),r.a.createElement(A.a,{className:"mt-5"},r.a.createElement("button",{type:"submit",disabled:o},"Save"))))))}),ye=a(65),Ne=(a(103),function(e){var t=Object(l.c)((function(e){return e.user})),a=Object(n.useState)(!1),c=Object(I.a)(a,2),s=c[0],o=c[1],i=Object(l.b)();return r.a.createElement("div",{className:"user-info"},r.a.createElement("button",{onClick:function(){return o(!s)}},r.a.createElement("img",{className:"img-fluid",src:t.photo||"/user.png",alt:t.name})),r.a.createElement("div",{className:"menu"+(s?" d-block":" d-none")},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(N.b,{to:"/profile"},"Profile")),r.a.createElement("li",null,r.a.createElement("button",{onClick:function(){return i((function(e){return fetch(G,{method:"POST"}).then((function(t){e(Z(null))}))}))}},"Logout")))))}),Ce=a(66),xe=(a(104),function(e){var t=Object(l.b)(),a=Object(l.c)((function(e){return e.user})),n=Object(C.h)(),c=Object(C.g)(),s=Object(x.useToasts)().addToast,o=function(){return t(S("all"))},i=function(){return t(S("assignments"))},u=function(){return t(function(e){var t=e.userId,a=e.success,n=e.failed;return function(e){fetch(M,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({assignedTo:t,text:"Write some here",date:Y()})}).then((function(e){return e.json()})).then((function(t){e(H(t.task)),a&&a()})).catch((function(e){n&&n()}))}}({userId:a._id||a.id,success:function(){return s("Task created",{appearance:"success",autoDismiss:!0})},failed:function(){return s("Network error, please verify your connection",{appearance:"error"})}}))},m=function(e,t){n.pathname!==e&&c.push(e),t()};return a?r.a.createElement("nav",{className:"navbar"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("button",{onClick:function(){return m("/home",o)}},r.a.createElement("span",null,"All"))),r.a.createElement("li",null,r.a.createElement("button",{onClick:function(){return m("/home",i)}},r.a.createElement("span",null,"Assignments"),r.a.createElement(ye.a,null))),r.a.createElement("li",null,r.a.createElement("button",{onClick:function(){return m("/home",u)}},r.a.createElement("span",null,"New"),r.a.createElement(Ce.a,null)))),r.a.createElement(Ne,null)):null}),Ie=a(36);var _e=function(e){var t=e.children,a=Object(Ie.a)(e,["children"]),n=Object(l.c)((function(e){return e.user}));return r.a.createElement(C.b,Object.assign({},a,{render:function(e){e.location;return n?r.a.createElement(C.a,{to:"/home"}):t}}))};var Pe=function(e){var t=e.children,a=Object(Ie.a)(e,["children"]),n=Object(l.c)((function(e){return e.user}));return r.a.createElement(C.b,Object.assign({},a,{render:function(e){e.location;return n?t:r.a.createElement(C.a,{to:"/"})}}))};a(105);var De=function(){return r.a.createElement(N.a,{className:"App"},r.a.createElement(x.ToastProvider,null,r.a.createElement(xe,null),r.a.createElement(C.d,null,r.a.createElement(_e,{exact:!0,path:"/"},r.a.createElement(me,null)),r.a.createElement(_e,{path:"/register"},r.a.createElement(Se,null)),r.a.createElement(Pe,{path:"/home"},r.a.createElement(ke,null)),r.a.createElement(Pe,{path:"/profile"},r.a.createElement(Te,null)))))};s.a.render(r.a.createElement(l.a,{store:y},r.a.createElement(De,null)),document.getElementById("root"))},69:function(e,t,a){e.exports=a(106)},82:function(e,t,a){},83:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){}},[[69,1,2]]]);
//# sourceMappingURL=main.174eb699.chunk.js.map